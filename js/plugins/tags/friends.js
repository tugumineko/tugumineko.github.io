const FriendsJS={requestAPI:(o,s,l)=>{let i=5;!function n(){new Promise((r,e)=>{let t=0,a=setTimeout(()=>{0===t&&(t=2,a=null,e("请求超时"),0==i)&&l()},5e3);fetch(o).then(function(e){if(2!==t&&(clearTimeout(a),r(e),a=null,t=1),e.ok)return e.json();throw new Error("Network response was not ok.")}).then(function(e){i=0,s(e)}).catch(function(e){0<i?(--i,setTimeout(()=>{n()},5e3)):l()})})}()},layout:n=>{const r=n.el;FriendsJS.requestAPI(n.api,function(e){r.querySelector(".loading-wrap").remove();var e=e.content,a="";e.forEach((e,r)=>{var t=(t=(t=(t='<div class="user-card">')+'<a class="card-link" target="_blank" rel="external noopener noreferrer"'+(' href="'+e.url+'">'))+('<img alt="'+e.title+'" src="'+(e.avatar||n.avatar)+'" onerror="errorImgAvatar(this)">'))+('<div class="name"><span>'+e.title+"</span></div>");a+=t=t+"</a>"+"</div>"}),r.querySelector(".group-body").innerHTML=a},function(){try{r.querySelector(".loading-wrap svg").remove(),r.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(e){}})},start:()=>{for(var e=document.getElementsByClassName("friendsjs-wrap"),r=0;r<e.length;r++){var t,a=e[r],n=a.getAttribute("api");null!=n&&((t=new Object).el=a,t.api=n,t.class=a.getAttribute("class"),t.avatar=volantis.GLOBAL_CONFIG.default.avatar,FriendsJS.layout(t))}}};FriendsJS.start();